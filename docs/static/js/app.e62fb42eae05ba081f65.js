webpackJsonp([1],{"1/oy":function(t,e){},"8svC":function(t,e){},Id91:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s={};n.d(s,"GET_QUESTION_PACKS",function(){return W}),n.d(s,"ADD_QUESTION_PACK",function(){return X}),n.d(s,"SAVE_QUESTION_PACK",function(){return Z}),n.d(s,"DELETE_QUESTION_PACK",function(){return tt});var i=n("7+uW"),o={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},staticRenderFns:[]};var a=n("VU/8")({name:"app"},o,!1,function(t){n("fHGY")},null,null).exports,r=n("/ocq"),u=n("mtWM"),c=n.n(u),d="http://"+window.location.hostname+":3001",l={user:{authenticated:!1},authenticate:function(t,e,n){var s=this;c.a.post(d+"/api/v1/auth",e).then(function(e){var i=e.data;t.$cookies.set("token",i.token,"1D"),t.$cookies.set("user_id",i.user._id,"1D"),t.validLogin=!0,s.user.authenticated=!0,n&&V.push(n)}).catch(function(e){var n=e.response.data;t.snackbar=!0,t.message=n.message})},signup:function(t,e,n){var s=this;c.a.post(d+"/api/v1/signup",e).then(function(){t.validSignUp=!0,s.authenticate(t,e,n)}).catch(function(e){var n=e.response.data;t.snackbar=!0,t.message=n.message})},signout:function(t,e){window.$cookies.remove("token"),window.$cookies.remove("user_id"),this.user.authenticated=!1,e&&V.push(e)},checkAuthentication:function(){var t=document.cookie;this.user.authenticated=!!t},getAuthenticationHeader:function(t){return"Bearer "+window.$cookies.get("token")}},p={methods:{submitSignout:function(){l.signout(this,"/login")},checkAuthentication:function(){return l.user.authenticated}}},f={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-navbar",{attrs:{type:"dark",variant:"info",toggleable:"md"}},[n("b-navbar-toggle",{attrs:{target:"nav_dropdown_collapse"}}),t._v(" "),n("b-navbar-brand",{attrs:{href:"/"}},[t._v("TestManager")]),t._v(" "),n("b-collapse",{attrs:{"is-nav":"",id:"nav_dropdown_collapse"}},[t.checkAuthentication()?n("b-navbar-nav",{staticClass:"ml-auto"},[n("b-nav-item",{on:{click:function(e){t.submitSignout()}}},[t._v("Выйти")])],1):t._e()],1)],1)},staticRenderFns:[]},h=n("VU/8")(p,f,!1,null,null,null).exports,m=n("Dd8w"),v=n.n(m),_=n("mvHQ"),b=n.n(_),k={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-card",[n("b-card-header",{domProps:{innerHTML:t._s(t.question.question)}}),t._v(" "),(t.question.type="выбор")?n("div",[n("b-list-group",t._l(t.question.answers,function(e){return n("b-list-group-item",{key:e._id,attrs:{variant:e.correct?"success":""}},[t._v("\n        "+t._s(e.answer)+"\n      ")])}))],1):t._e()],1)},staticRenderFns:[]},g=n("VU/8")({props:["question"]},k,!1,null,null,null).exports,q="http://"+window.location.hostname+":3001",w={data:function(){return{questionTypes:["выбор","ввод ответа"],customToolbar:[["bold","italic","underline"],[{list:"ordered"},{list:"bullet"}],["code-block"]]}},props:["question_pack_id","question"],methods:{addSaveQuestion:function(){var t=this;"выбор"===this.question.type&&(this.question.answers=this.question.choise_answers);var e={_id:this.question._id,question:this.question.question,type:this.question.type,question_pack_id:this.question_pack_id,answers:this.question.answers};return this.question._id?c.a.put(q+"/api/v1/question/single",e,{headers:{Authorization:l.getAuthenticationHeader(this)}}).then(function(e){var n=e.data;t.$emit("updated",n)}):c.a.post(q+"/api/v1/question",e,{headers:{Authorization:l.getAuthenticationHeader(this)}}).then(function(e){var n=e.data;t.$emit("added",n)})}}},E={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("b-row",[n("b-col",{attrs:{cols:"9"}},[n("vue-editor",{attrs:{editorToolbar:t.customToolbar},model:{value:t.question.question,callback:function(e){t.$set(t.question,"question",e)},expression:"question.question"}})],1),t._v(" "),n("b-col",[n("b-form-group",{attrs:{label:"Тип вопроса"}},[n("b-form-select",{attrs:{options:t.questionTypes},model:{value:t.question.type,callback:function(e){t.$set(t.question,"type",e)},expression:"question.type"}})],1)],1)],1),t._v(" "),n("b-row",{staticClass:"mt-2"},[n("b-col",[t._v("Ответ(ы):")])],1),t._v(" "),"выбор"==t.question.type?n("div",t._l(t.question.choise_answers,function(e,s){return n("b-input-group",{key:s,staticClass:"mt-2"},[n("b-input-group-prepend",{attrs:{"is-text":""}},[n("b-form-checkbox",{staticClass:"mr-0",attrs:{plain:""},model:{value:e.correct,callback:function(n){t.$set(e,"correct",n)},expression:"answer.correct"}})],1),t._v(" "),n("b-form-input",{attrs:{type:"text",size:"sm"},model:{value:e.answer,callback:function(n){t.$set(e,"answer",n)},expression:"answer.answer"}}),t._v(" "),n("b-input-group-append",[s!=t.question.choise_answers.length-1?n("b-btn",{attrs:{size:"sm",variant:"danger"},on:{click:function(){-1!==s&&t.question.choise_answers.splice(s,1)}}},[n("i",{staticClass:"fas fa-minus"})]):t._e(),t._v(" "),s==t.question.choise_answers.length-1?n("b-btn",{attrs:{size:"sm",variant:"success"},on:{click:function(e){t.question.choise_answers.push({answer:"",correct:!1})}}},[n("i",{staticClass:"fas fa-plus"})]):t._e()],1)],1)})):"ввод ответа"==t.question.type?n("div",[t._v("\n    "+t._s(t.question.type)+"\n  ")]):t._e()],1)},staticRenderFns:[]},P=n("VU/8")(w,E,!1,null,null,null).exports,C=n("woOf"),Q=n.n(C),y={title:"Вы уверены?",yes:"Да",no:"Нет"},A={data:function(){return{isOpen:!1,randomId:"clickConfirm"+this._uid,target:null,allow:!1}},props:{buttonSize:{type:String,default:"",validator:function(t){return["lg","","sm"].includes(t)}},disabled:{type:Boolean,default:!1},messages:{type:Object,default:function(){return y}},noClass:{type:[String,Array,Object],default:"btn btn-secondary"},noIcon:{type:[String,Array,Object],default:"fa fa-times"},placement:{type:String,default:"top"},yesClass:{type:[String,Array,Object],default:"btn btn-primary"},yesIcon:{type:[String,Array,Object],default:"fa fa-check"}},computed:{buttonSizeClass:function(){return this.buttonSize?"btn-"+this.buttonSize:""},messagesMerged:function(){return Q()({},y,this.messages)}},methods:{onHidden:function(){this.target=null},onOk:function(){if(null!==this.target){this.allow=!0;var t=new MouseEvent("click",{bubbles:!0,cancelable:!0,composed:!0});this.target.dispatchEvent(t)||console.error("Confirmed event failed to dispatch"),this.allow=!1}this.onCancel()},onCancel:function(){this.isOpen=!1},interceptEvent:function(t){this.disabled||(this.target=t.target,this.allow||(this.isOpen=!0,this.setFocusOnButtonYes(),t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()))},setFocusOnButtonYes:function(){var t=this;this.$nextTick(function(){t.$nextTick(function(){t.isOpen&&t.$refs.buttonYes.focus()})})}},beforeDestroy:function(){this.isOpen&&this.onCancel()}},S={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("span",[n("span",{ref:"trigger",attrs:{id:t.randomId,tabindex:"-1"},on:{"!click":function(e){return t.interceptEvent(e)}}},[t._t("default")],2),t._v(" "),n("b-popover",{ref:"popover",staticClass:"click-confirm",attrs:{target:t.randomId,show:t.isOpen,placement:t.placement,title:t.messages.title,triggers:"blur"},on:{"update:show":function(e){t.isOpen=e},hidden:t.onHidden}},[n("div",{staticClass:"text-center"},[n("button",{ref:"buttonYes",class:[t.yesClass,t.buttonSizeClass],on:{click:function(e){return e.preventDefault(),t.onOk(e)}}},[t.yesIcon?n("span",{class:t.yesIcon,attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "+t._s(t.messages.yes)+"\n      ")]),t._v(" "),n("button",{ref:"buttonNo",class:[t.noClass,t.buttonSizeClass],on:{click:function(e){return e.preventDefault(),t.onCancel(e)}}},[t.noIcon?n("span",{class:t.noIcon,attrs:{"aria-hidden":"true"}}):t._e(),t._v(" "+t._s(t.messages.no)+"\n      ")])])])],1)},staticRenderFns:[]},U=n("VU/8")(A,S,!1,null,null,null).exports,O=n("NYxO"),x="http://"+window.location.hostname+":3001",I={question:"",type:"выбор",choise_answers:[{answer:"",correct:!1},{answer:"",correct:!1}]},T={components:{"question-card":g,"question-editor":P,"click-confirm":U},data:function(){return{newQuestionPackName:"",needUpdateQuestionCounts:!1,questionsEditing:!1,questionPackForEdit:{},questionEditorFields:[{key:"question",label:"Вопрос"},{key:"actions",label:"Действия"}],questionEditorItems:[],newQuestion:JSON.parse(b()(I))}},props:["fields"],computed:v()({},Object(O.b)({question_packs:"questionPack/questionPacks"})),mounted:function(){this.$store.dispatch("questionPack/GET_QUESTION_PACKS")},methods:{saveQuestionPack:function(t){this.$store.dispatch("questionPack/SAVE_QUESTION_PACK",t),t.editing=!1},addQuestionPack:function(){this.$store.dispatch("questionPack/ADD_QUESTION_PACK",this.newQuestionPackName),this.$refs.addQuestionPackModal.hide()},deleteQuestionPack:function(t){this.$store.dispatch("questionPack/DELETE_QUESTION_PACK",t)},handleAddQuestionPackSubmit:function(t){t.preventDefault(),this.newQuestionPackName?this.addQuestionPack():alert("Поле не должно быть пустым")},getQuestions:function(t){return c.a.get(x+"/api/v1/question",{params:{question_pack:t._id},headers:{Authorization:l.getAuthenticationHeader(this)}}).then(function(e){var n=e.data;return t.questions=n.length,n})},getQuestionCount:function(t){if(this.needUpdateQuestionCounts||void 0===t.questions)return this.getQuestions(t)},getQuestionsForEditor:function(t){var e=this;(this.questionPackForEdit!==t||this.needUpdateQuestionCounts)&&(this.questionPackForEdit=t,this.getQuestions(t).then(function(t){e.questionEditorItems=e.dataParser(t,"question","type","answers","_id")}))},showQuestionEditorModal:function(t){t?(this.newQuestion=JSON.parse(b()(t)),"выбор"===this.newQuestion.type&&(this.newQuestion.choise_answers=this.newQuestion.answers)):this.newQuestion=JSON.parse(b()(I)),this.$refs.addEditQuestionModal.show()},newQuestionAdded:function(t){this.questionEditorItems.push(t.question)},questionUpdated:function(t){var e=this.questionEditorItems.findIndex(function(e){return e._id===t.question._id});-1!==e&&this.questionEditorItems.splice(e,1,t.question)},deleteQuestion:function(t){var e=this;return console.log("test"),c.a.delete(x+"/api/v1/question",{params:{question_id:t._id},headers:{Authorization:l.getAuthenticationHeader(this)}}).then(function(n){n.data;var s=e.questionEditorItems.indexOf(t);-1!==s&&e.questionEditorItems.splice(s,1)})},dataParser:function(t){for(var e=arguments.length,n=Array(e>1?e-1:0),s=1;s<e;s++)n[s-1]=arguments[s];var i=[];return t.forEach(function(t){var e={};n.forEach(function(n){return e[n]=t[n]}),i.push(e)}),i}}},$={render:function(){var t=this,e=this,n=e.$createElement,s=e._self._c||n;return s("div",[e.questionsEditing?e._e():s("b-button-toolbar",{staticClass:"my-2"},[s("b-button-group",[s("b-btn",{directives:[{name:"b-modal",rawName:"v-b-modal.addQuestionPackModal",modifiers:{addQuestionPackModal:!0}}],attrs:{size:"sm"}},[e._v("Добавить")])],1)],1),e._v(" "),e.questionsEditing?s("b-button-toolbar",{staticClass:"my-2"},[s("b-button-group",[s("b-btn",{attrs:{size:"sm"},on:{click:function(t){e.showQuestionEditorModal(null)}}},[e._v("\n        Добавить новый вопрос\n      ")]),e._v(" "),s("b-btn",{attrs:{size:"sm",variant:"outline-secondary"},on:{click:function(t){e.questionsEditing=!1}}},[e._v("\n        Назад\n      ")])],1)],1):e._e(),e._v(" "),e.questionsEditing?e.questionsEditing?s("b-table",{attrs:{striped:"",fields:e.questionEditorFields,items:e.questionEditorItems},scopedSlots:e._u([{key:"question",fn:function(t){return[s("div",{staticClass:"pr-2"},[s("a",{staticClass:"question",attrs:{href:"#"},domProps:{innerHTML:e._s(t.item.question)},on:{click:function(n){e.showQuestionEditorModal(t.item)}}}),e._v(" "),s("b-badge",{attrs:{pill:""}},[e._v(e._s(t.item.type))])],1)]}},{key:"actions",fn:function(t){return[s("div",{staticClass:"text-sm-right"},[s("b-button",{attrs:{size:"sm"},on:{click:function(e){return e.stopPropagation(),t.toggleDetails(e)}}},[s("i",{staticClass:"fas fa-info-circle",attrs:{"aria-hidden":"true"}})]),e._v(" "),s("click-confirm",[s("b-button",{attrs:{size:"sm"},on:{click:function(n){n.stopPropagation(),e.deleteQuestion(t.item)}}},[s("i",{staticClass:"fas fa-trash",attrs:{"aria-hidden":"true"}})])],1)],1)]}},{key:"row-details",fn:function(t){return[s("question-card",{attrs:{question:t.item}})]}}])}):e._e():s("b-table",{attrs:{striped:"",fields:e.fields,items:e.question_packs},scopedSlots:e._u([{key:"title",fn:function(t){return[s("a",{attrs:{href:"#"},on:{click:function(n){e.questionsEditing=!e.questionsEditing,e.getQuestionsForEditor(t.item)}}},[e._v(e._s(t.item.title))])]}},{key:"actions",fn:function(t){return[s("div",{staticClass:"text-sm-right"},[s("b-button",{attrs:{size:"sm"},on:{click:function(n){n.stopPropagation(),e.getQuestionCount(t.item),t.toggleDetails()}}},[s("i",{staticClass:"fas fa-info-circle",attrs:{"aria-hidden":"true"}})]),e._v(" "),s("click-confirm",[s("b-button",{attrs:{size:"sm"},on:{click:function(n){n.stopPropagation(),e.deleteQuestionPack(t.item)}}},[s("i",{staticClass:"fas fa-trash",attrs:{"aria-hidden":"true"}})])],1)],1)]}},{key:"row-details",fn:function(t){return[s("b-card",[s("b-row",{staticClass:"mb-2"},[s("b-col",{staticClass:"text-sm-right",attrs:{sm:"3"}},[s("b",[e._v("Вопросов:")])]),e._v(" "),s("b-col",{attrs:{sm:"3"},domProps:{textContent:e._s(t.item.questions)}}),e._v(" "),s("b-col",{staticClass:"text-sm-right col-sm"},[s("b-button",{attrs:{size:"sm"},on:{click:function(e){t.item.editing=!t.item.editing}}},[s("i",{staticClass:"fas fa-edit",attrs:{"aria-hidden":"true"}})])],1)],1),e._v(" "),t.item.editing?s("b-row",[s("b-input-group",{attrs:{prepend:"Новое название"}},[s("b-form-input",{model:{value:t.item.title,callback:function(n){e.$set(t.item,"title",n)},expression:"row.item.title"}}),e._v(" "),s("b-input-group-append",[s("b-btn",{attrs:{variant:"success"},on:{click:function(n){e.saveQuestionPack(t.item)}}},[s("i",{staticClass:"far fa-save"})])],1)],1)],1):e._e()],1)]}}])}),e._v(" "),e.questionsEditing?e._e():s("b-modal",{ref:"addQuestionPackModal",attrs:{id:"addQuestionPackModal",title:"Добавить новый сборник вопросов","ok-title":"Сохранить","cancel-title":"Отмена"},on:{ok:e.handleAddQuestionPackSubmit,show:function(t){e.newQuestionPackName=""}}},[s("b-form",{on:{submit:function(t){return t.stopPropagation(),t.preventDefault(),e.handleAddQuestionPackSubmit(t)}}},[s("b-input-group",{attrs:{size:"sm",prepend:"Название"}},[s("b-form-input",{model:{value:e.newQuestionPackName,callback:function(t){e.newQuestionPackName=t},expression:"newQuestionPackName"}})],1)],1)],1),e._v(" "),e.questionsEditing?s("b-modal",{ref:"addEditQuestionModal",attrs:{id:"addEditQuestionModal",title:"Редактирование вопроса","ok-title":"Сохранить","cancel-title":"Отмена",size:"lg"},on:{ok:function(){t.$refs.questionEditor.addSaveQuestion()}}},[s("question-editor",{ref:"questionEditor",attrs:{question_pack_id:e.questionPackForEdit._id,question:e.newQuestion},on:{updated:e.questionUpdated,added:e.newQuestionAdded}})],1):e._e()],1)},staticRenderFns:[]};var N={components:{"app-header":h,"question-pack-table":n("VU/8")(T,$,!1,function(t){n("i5cf")},null,null).exports},data:function(){return{questionPackHeaders:[{key:"title",label:"Название"},{key:"actions",label:"Действия"}]}},methods:{}},z={render:function(){var t=this.$createElement,e=this._self._c||t;return e("b-container",[e("app-header"),this._v(" "),e("question-pack-table",{attrs:{fields:this.questionPackHeaders}})],1)},staticRenderFns:[]},D=n("VU/8")(N,z,!1,null,null,null).exports,F={data:function(){return{signUpVisible:!1,rules:[function(t){return!!t||"This field is required"}],credentials:{username:"",password:""},newUser:{username:"",password:""}}},methods:{submitAuthentication:function(){l.authenticate(this,this.credentials,"/")},submitSignUp:function(){l.signup(this,this.newUser,"/")}}},H={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-container",[n("app-header"),t._v(" "),n("div",{staticClass:"module form-module"},[n("div",{staticClass:"toggle",on:{click:function(e){t.signUpVisible=!t.signUpVisible}}},[n("i",{staticClass:"fa fa-times fa-pencil"}),t._v(" "),n("div",{staticClass:"tooltip"},[t._v("Click me")])]),t._v(" "),n("transition",{attrs:{name:"slide-fade"}},[t.signUpVisible?t._e():n("div",{staticClass:"form"},[n("h2",[t._v("Войти в свой аккаунт")]),t._v(" "),n("b-form",[n("b-form-input",{attrs:{placeholder:"Имя пользователя",rules:t.rules,required:""},model:{value:t.credentials.username,callback:function(e){t.$set(t.credentials,"username","string"==typeof e?e.trim():e)},expression:"credentials.username"}}),t._v(" "),n("b-form-input",{attrs:{placeholder:"Пароль",rules:t.rules,required:"",type:"password"},model:{value:t.credentials.password,callback:function(e){t.$set(t.credentials,"password",e)},expression:"credentials.password"}}),t._v(" "),n("b-button",{on:{click:function(e){t.submitAuthentication()}}},[t._v("Войти")])],1)],1)]),t._v(" "),n("div",{staticClass:"form"},[n("h2",[t._v("Создать аккаунт")]),t._v(" "),n("b-form",[n("b-form-input",{attrs:{placeholder:"Имя пользователя",rules:t.rules,required:""},model:{value:t.newUser.username,callback:function(e){t.$set(t.newUser,"username",e)},expression:"newUser.username"}}),t._v(" "),n("b-form-input",{attrs:{placeholder:"Пароль",rules:t.rules,required:"",type:"password"},model:{value:t.newUser.password,callback:function(e){t.$set(t.newUser,"password",e)},expression:"newUser.password"}}),t._v(" "),n("b-button",{on:{click:function(e){t.submitSignUp()}}},[t._v("Зарегестрироваться")])],1)],1)],1)],1)},staticRenderFns:[]};var M=n("VU/8")(F,H,!1,function(t){n("8svC")},null,null).exports;i.a.component("app-header",h),i.a.use(r.a);var K=new r.a({routes:[{path:"/",name:"Home",components:{default:D,"app-header":h},props:!0,meta:{requiredAuth:!0}},{path:"/login",name:"Authentication",component:M}]});K.beforeEach(function(t,e,n){t.meta.requiredAuth?l.user.authenticated?n():K.push("/login"):n()});var V=K,R=n("ppUw"),j=n.n(R),L=n("e6fC"),Y=n("BO1k"),B=n.n(Y),G=c.a.create({baseURL:"https://testingmanager.herokuapp.com/"});G.defaults.headers.common.Authorization=l.getAuthenticationHeader(this);var J=G;function W(t){var e=t.commit;J.get("/api/v1/question_pack").then(function(t){var n=t.data;e("SET_QUESTION_PACKS",n)})}function X(t,e){var n=t.commit;J.post("/api/v1/question_pack",{title:e}).then(function(t){var e=t.data;n("ADD_QUESTION_PACK",e.question_pack)})}function Z(t,e){t.commit;J.put("/api/v1/question_pack/single",{_id:e._id,title:e.title})}function tt(t,e){var n=t.commit;J.delete("/api/v1/question_pack",{params:{question_pack_id:e._id}}).then(function(t){t.data;n("DELETE_QUESTION_PACK",e)})}var et={namespaced:!0,state:{questionPacks:[]},actions:s,mutations:{SET_QUESTION_PACKS:function(t,e){t.questionPacks=e;var n=!0,s=!1,o=void 0;try{for(var a,r=B()(t.questionPacks);!(n=(a=r.next()).done);n=!0){var u=a.value;i.a.set(u,"editing",!1),i.a.set(u,"questions",void 0)}}catch(t){s=!0,o=t}finally{try{!n&&r.return&&r.return()}finally{if(s)throw o}}},ADD_QUESTION_PACK:function(t,e){i.a.set(e,"editing",!1),i.a.set(e,"questions",void 0),t.questionPacks.push(e)},DELETE_QUESTION_PACK:function(t,e){var n=t.questionPacks.indexOf(e);-1!==n&&t.questionPacks.splice(n,1)}},getters:{questionPacks:function(t){return t.questionPacks}}};i.a.use(O.a);var nt=new O.a.Store({modules:{questionPack:et},strict:!1}),st=n("aYpo"),it=n.n(st);i.a.use(j.a),i.a.use(L.a),i.a.use(it.a),i.a.config.productionTip=!1,l.checkAuthentication(),new i.a({el:"#app",router:V,components:{App:a},template:"<App/>",store:nt})},fHGY:function(t,e){},i5cf:function(t,e){},zj2Q:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.e62fb42eae05ba081f65.js.map